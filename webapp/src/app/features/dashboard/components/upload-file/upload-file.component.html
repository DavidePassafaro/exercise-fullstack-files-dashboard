<div class="upload-section">
  <div
    class="drop-zone"
    [class.active]="isDragOver()"
    (dragover)="onDragOver($event)"
    (dragleave)="onDragLeave($event)"
    (drop)="onDrop($event)"
    (click)="fileInput.click()"
  >
    <div class="drop-zone-content">
      <div class="icon-container">
        <i class="csv-icon">download</i>
      </div>

      <div class="text-container">
        <span class="main-text">Click to upload or drag & drop</span>
        <span class="sub-text">Only .csv files supported (max 10 files)</span>
      </div>
    </div>

    <input
      type="file"
      #fileInput
      accept=".csv"
      class="hidden-input"
      multiple
      (change)="onFileSelected($event)"
    />
  </div>

  @if (selectedFiles().length > 0) {
    <div class="file-list-container">
      <div class="file-list-header">
        <h3>Selected Files ({{ selectedFiles().length }})</h3>
        <button class="clear-all" (click)="selectedFiles.set([])">Clear all</button>
      </div>

      <div class="file-list">
        @for (file of selectedFiles(); track $index) {
          <div class="file-card">
            <div class="file-info">
              <div class="file-icon">
                <i class="csv-icon">file-text</i>
              </div>

              <div class="file-details">
                <span class="file-name">{{ file.name }}</span>
                <span class="file-size">{{ file.size | fileSize }}</span>
              </div>
            </div>

            <button class="remove-btn" (click)="removeFile($index); $event.stopPropagation()">
              <i class="csv-icon">remove</i>
            </button>
          </div>
        }
      </div>

      <div class="actions">
        <button class="upload-btn" [disabled]="isUploading()" (click)="handleMultipleUpload()">
          @if (isUploading()) {
            <span class="spinner"></span>
            Uploading...
          } @else {
            Upload to Server
          }
        </button>
      </div>
    </div>
  }
</div>
